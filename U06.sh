# /bin/bash

# 작성날짜 : 2022년 6월 8일 
# 작성자 : 우은지
# 동작방식 : path 환경변수가 안전한지 확인하기 위한 코드 
# -> path 환경변수에 .이 맨 앞이나 중간에 있는 경우 unsafe로 판단, 반대의 경우 safe로 판단

vuln_number="U6"
vuln_name="root 홈, 패스 디렉터리 권한 및 패스 설정"
vuln_result_date="$(date +%Y)-$(date +%m)-$(date +%d) $(date +%H):$(date +%M):$(date +%S)"
vuln_type="계정 관리"
vuln_severity="3"
vuln_result=""
vuln_desc=""
vuln_host_id=$(hostname -I)

check=$(echo $PATH | egrep "\.:|::|:.:" )

if [ -z $check ];then
    vuln_result="취약하지 않음"
    vuln_desc="path 환경변수에 .이 맨 앞에 포함 안됨"
else
    vuln_result="취약함"
    vuln_desc="path 환경변수에 .이 맨 앞에 포함"
fi

echo "{\"vuln_number\":\"${vuln_number}\", \"vuln_name\":\"${vuln_name}\", \"vuln_result_date\":\"${vuln_result_date}\", \"vuln_type\":\"${vuln_type}\", \"vuln_severity\":\"${vuln_severity}\", \"vuln_result\":\"${vuln_result}\", \"vuln_desc\":\"${vuln_desc}\", \"vuln_host_id\":\"${vuln_host_id}\"}" >> result.log