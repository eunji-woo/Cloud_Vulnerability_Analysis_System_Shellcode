# /bin/bash

# 작성날짜 : 2022년 6월 8일 
# 작성자 : 우은지
# 동작방식 : 패스워드 복잡성 설정이 안전한지 확인하기 위한 코드 (function.sh이 어디에 있는거죠..)

. function.sh
checkfile=/etc/security/pwquality.conf

value1=$(FindPatternReturnValue $checkfile minlen)

if [ %value1 = None ]; then
    echo "[unsafe]minlen set is 8" >> u02.log
else   
    if [ $value1 -ge 12 ]; then
        ret1=$(IsFindPattern $checkfile dcredit)
        ret2=$(IsFindPattern $checkfile ucreditt)
        ret3=$(IsFindPattern $checkfile Icredit)
        ret4=$(IsFindPattern $checkfile ocredit)
        if [ $ret1 -eq -1  -a $ret2 -eq -1 -a $ret3 -eq -1 -a $ret4 -eq -1]; then
            echo "[safe]\n\n" >> u02.log
        else
            echo "WARN, u-02 unsafe, minlen OK, other setting is bad"
            echo "[unsafe]minlen OK, other setting is bad\n\n" >> u02.log
        fi
    else
        echo "[unsafe]minlen X\n\n" >> u02.log
    fi
fi
