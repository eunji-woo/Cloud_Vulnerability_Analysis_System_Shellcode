#!/bin/bash

# 작성날짜 : 2022년 6월 8일 
# 작성자 : 우은지
# 동작방식 : r 계열 서비스들이 비활성화가 되어있는지 xinetd 디렉토리 밑에 있는 파일들을 보며 확인
# ->r 서비스 파일들을 cat 해온 뒤, disable이 grep 될 경우 safe로 판단, grep 되지 않을 경우 unsafe로 판단

for x in `ls -1 /etc/xinetd.d | egrep 'rsh'*` # r 계열 서비스들 파일 이름이 서비스이름-stream, dgram,, 등 다양
do
    result=$(cat /etc/xinetd.d/$x | egrep disable*)
    if [[ $result == *yes* ]]; then
        echo "[safe] $x is disable" >> u22.log
    else
        echo "[unsafe] $x is able" >> u22.log
    fi
done


for x in `ls -1 /etc/xinetd.d | egrep 'rlogin'*`
do
    result=$(cat /etc/xinetd.d/$x | egrep disable*)
    if [[ $result == *yes* ]]; then
        echo "[safe] $x is disable" >> u22.log
    else
        echo "[unsafe] $x is able" >> u22.log
    fi
done


for x in `ls -1 /etc/xinetd.d | egrep 'rexec'*`
do
    result=$(cat /etc/xinetd.d/$x | egrep disable*)
    if [[ $result == *yes* ]]; then
        echo "[safe] $x is disable" >> u22.log
    else
        echo "[unsafe] $x is able" >> u22.log
    fi
done