#!/bin/bash

# 작성날짜 : 2022년 6월 8일 
# 작성자 : 우은지
# 동작방식 : root 계정 원격 접속 제한을 위한 코드 -> root가 로그인 가능한 터미널 장치들을 확인하고, 터미널이 있을 경우 각 check 변수의 값을 0으로 변경, 
# 마지막에 check 변수들을 and 연산하여 모두 1인 경우 safe으로 판단하고 하나라도 0인 경우 unsafe로 판단

check1=1
check2=1
check3=1

# etc/securetty는 root가 로그인 가능한 터미널 장치들을 나열해둔 파일

if [ `cat /etc/securetty | grep pts`];then # pseudo terminal slave 사용하는지 확인
   echo "use telnet" >> u01.log
   check1=0
else
   echo "unused telnet" >> u01.log
fi

if [ `cat /etc/securetty | grep tty`];then # tele type writer 사용하는지 확인
   echo "use tty" >> u01.log
   check2=0
else
   echo "unused tty" >> u01.log
fi

if [[ `cat /etc/ssh/sshd_config | grep PermitRootLogin` =~ "yes" ]];then # ssh 사용하는지 확인
   echo "use ssh" >> u01.log
   check3=0
else
   echo "unused ssh" >> u01.log
fi


if [ $check1 = 1 -a $check2 = 1 -a $check3 = 1 ]; then  #check 변수 3개 중 1개라도 0이면 unsafe로 판단되도록 구현 
    echo -e "[safe]\n\n" >> u01.log
else
    echo -e "[unsafe]\n\n" >> u01.log 
fi