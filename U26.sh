#!/bin/bash

# 작성날짜 : 2022년 8월 31일
# 작성자 : 이은경
# 동작방식 : automountd서비스 데몬을 확인하여 해당 서비스가 활성화 되어 있으면 unsafe, 비활성화는 safe



vuln_number="U26"
vuln_name="automountd 제거"
vuln_result_date="$(date +%Y)-$(date +%m)-$(date +%d) $(date +%H):$(date +%M):$(date +%S)"
vuln_type="서비스 관리"
vuln_severity="3"
vuln_result="취약하지 않음"
vuln_desc="automount 서비스가 비활성화 되어 있음"
vuln_host_id=$(hostname -I)

check="`ps -ef | grep automount`"

if [ -n "$check" ];then
    vuln_desc="automountd 서비스가 활성화 되어 있음"
    vuln_result="취약함"
fi

echo "{\\"vuln_number\\":\\"${vuln_number}\\", \\"vuln_name\\":\\"${vuln_name}\\", \\"vuln_result_date\\":\\"${vuln_result_date}\\", \\"vuln_type\\":\\"${vuln_type}\\", \\"vuln_severity\\":\\"${vuln_severity}\\", \\"vuln_result\\":\\"${vuln_result}\\", \\"vuln_desc\\":\\"${vuln_desc}\\", \\"vuln_host_id\\":\\"${vuln_host_id}\\"}" >> result.log
