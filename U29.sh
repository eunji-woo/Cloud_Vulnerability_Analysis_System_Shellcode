#!/bin/bash

# 작성날짜 : 2022년 7월 6일 
<<<<<<< HEAD
# 작성자 : 우은지, 이은경
# 동작방식 : 사용하지 않는 tftp, talk 서비스가 활성화 되어있는지 확인하는 코드

value1=$(cat /etc/xinetd.d/tftp | grep "disable")
value2=$(cat /etc/xinetd.d/talk | grep "disable")
value3=$(cat /etc/xinetd.d/ntalk | grep "disable")
vuln_number="U29"
vuln_name="tftp, talk 서비스 비활성화"
vuln_result_date="$(date +%Y)-$(date +%m)-$(date +%d) $(date +%H):$(date +%M):$(date +%S)"
vuln_type="서비스 관리"
vuln_severity="3"
vuln_result="취약하지 않음"
vuln_desc="tftp, talk 서비스가 비활성화 되어 있음"
vuln_host_id=$(hostname -I)

# /etc/xinetd.conf 파일이란: 해당 디렉토리 내에 존재하는 inetd 서비스 파일들에 공통적으로 적용되는 설정 내용들이 저장되어있는 파일
if [ ${value1:(-3)} == "yes" ] 
then
    vuln_result="취약함"
    vuln_desc="tftp 서비스가 활성화 되어 있음"
fi

if [ ${value2:(-3)} == "yes"] || [${value3:(-3) =="yes"} ] 
then
    vuln_result="취약함"
    vuln_desc="talk 서비스가 활성화 되어 있음"
fi

echo "{\"vuln_number\":\"${vuln_number}\", \"vuln_name\":\"${vuln_name}\", \"vuln_result_date\":\"${vuln_result_date}\", \"vuln_type\":\"${vuln_type}\", \"vuln_severity\":\"${vuln_severity}\", \"vuln_result\":\"${vuln_result}\", \"vuln_desc\":\"${vuln_desc}\", \"vuln_host_id\":\"${vuln_host_id}\"}" >> result.log
=======
# 작성자 : 우은지
# 동작방식 : 사용하지 않는 tftp, talk 서비스가 활성화 되어있는지 확인하는 코드

# /etc/xinetd.conf 파일이란: 해당 디렉토리 내에 존재하는 inetd 서비스 파일들에 공통적으로 적용되는 설정 내용들이 저장되어있는 파일
if [ `cat /etc/xinetd.conf | grep "tftp|talk|"` ] 
    then
        echo -e "[unsafe] use tftp, talk service\n\n" >> u29.log
    else
        echo -e "[safe] unuse tftp, talk service\n\n" >> u29.log
fi
>>>>>>> 03f5de9f689ec24457c298763162cb95ebfbba95
