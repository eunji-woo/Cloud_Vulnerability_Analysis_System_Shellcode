#!/bin/bash

# 작성날짜 : 2022년 6월 8일 
# 작성자 : 우은지
# 동작방식 : world writable 파일을 find 명령으로 찾아보고 출력시켜 확인해보기 위한 코드

vuln_number="U16"
vuln_name="world writable 파일 점검"
vuln_result_date="$(date +%Y)-$(date +%m)-$(date +%d) $(date +%H):$(date +%M):$(date +%S)"vuln_type="계정 관리"
vuln_severity="3"
vuln_result="취약함"
vuln_desc=$(find / -type f -perm -2 -exec ls -l '{}' \; 2>/dev/null)
vuln_host_id=$(hostname -I)

# find / = 루트 디렉토리부터 모든 파일 탐색
# type -f = 일반 파일만을 검색
# perm -2 = 구글링해도 안 나오는데 흐름상,, world writable 파일을 의미하는 것 같음

if [ -z "$vuln_desc" ]; then
    vuln_result="취약하지 않음" 
else
    vuln_desc="world writable 파일이 존재(따로 설정한 파일이라면 무시)"
fi

echo "{\\"vuln_number\\":\\"${vuln_number}\\", \\"vuln_name\\":\\"${vuln_name}\\", \\"vuln_result_date\\":\\"${vuln_result_date}\\", \\"vuln_type\\":\\"${vuln_type}\\", \\"vuln_severity\\":\\"${vuln_severity}\\", \\"vuln_result\\":\\"${vuln_result}\\", \\"vuln_desc\\":\\"${vuln_desc}\\", \\"vuln_host_id\\":\\"${vuln_host_id}\\"}" >> result.log
