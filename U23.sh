#!/bin/bash

# 작성날짜 : 2022년 6월 8일 
# 작성자 : 우은지
# 동작방식 : dos 공격에 취약한 서비스들이 disable 상태인지 xinetd 밑에 파일들을 검사해보는 코드
# dos 공격에 취약헌 서비스 파일들을 cat 해온 뒤, disable이 grep 될 경우 safe로 판단, grep 되지 않을 경우 unsafe로 판단

for x in `ls -1 /etc/xinetd.d | egrep 'echo'*` # 서비스들 파일 이름이 서비스이름-stream, dgram,, 등 다양
do
    result=$(cat /etc/xinetd.d/$x | egrep disable*)
    if [[ $result == *yes* ]]; then
        echo "[safe] $x is disable" >> u23.log
    else
        echo "[unsafe] $x is able" >> u23.log
    fi
done


for x in `ls -1 /etc/xinetd.d | egrep 'discard'*`
do
    result=$(cat /etc/xinetd.d/$x | egrep disable*)
    if [[ $result == *yes* ]]; then
        echo "[safe] $x is disable" >> u23.log
    else
        echo "[unsafe] $x is able" >> u23.log
    fi
done


for x in `ls -1 /etc/xinetd.d | egrep 'daytime'*`
do
    result=$(cat /etc/xinetd.d/$x | egrep disable*)
    if [[ $result == *yes* ]]; then
        echo "[safe] $x is disable" >> u23.log
    else
        echo "[unsafe] $x is able" >> u23.log
    fi
done


for x in `ls -1 /etc/xinetd.d | egrep 'chargen'*`
do
    result=$(cat /etc/xinetd.d/$x | egrep disable*)
    if [[ $result == *yes* ]]; then
        echo "[safe] $x is disable" >> u23.log
    else
        echo "[unsafe] $x is able" >> u23.log
    fi
done