#!/bin/bash

# 작성날짜 : 2022년 6월 2일, 9월 13일 
# 작성자 : 우은지, 이은경
# 동작방식 : 비인가된 시스템이 NFS 시스템 마운트가 가능한지 확인한다.
# nfs 서비스 관련 데몬이 활성화 되어 있는 경우 unsafe, 비활성화 되어 있는 경우 safe

vuln_number="U24"
vuln_name="NFS 서비스 비활성화"
vuln_result_date="$(date +%Y)-$(date +%m)-$(date +%d) $(date +%H):$(date +%M):$(date +%S)"
vuln_type="서비스 관리"
vuln_severity="3"
vuln_result="취약하지 않음"
vuln_desc="nfs 서비스 관련 데몬이 활성화 되어 있음"
vuln_host_id=$(hostname -I)

check=`ps -ef | grep nfsd`

if [ -n "$check" ];then
    vuln_desc="NFS 서비스 관련 데몬이 활성화 되어 있음"
    vuln_result="취약함"
fi

echo "{\\"vuln_number\\":\\"${vuln_number}\\", \\"vuln_name\\":\\"${vuln_name}\\", \\"vuln_result_date\\":\\"${vuln_result_date}\\", \\"vuln_type\\":\\"${vuln_type}\\", \\"vuln_severity\\":\\"${vuln_severity}\\", \\"vuln_result\\":\\"${vuln_result}\\", \\"vuln_desc\\":\\"${vuln_desc}\\", \\"vuln_host_id\\":\\"${vuln_host_id}\\"}" >> result.log
