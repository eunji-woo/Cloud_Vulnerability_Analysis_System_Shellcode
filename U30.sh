#!/bin/bash

# 작성날짜 : 2022년 7월 6일 
<<<<<<< HEAD
# 작성자 : 우은지, 이은경
# 동작방식 : sendmail 서비스를 활성화 되어있는지 확인하고 활성화 되어있다면 버전 확인

value1=$(ps -ef | grep "sendmail")
#value2=$(cat /etc/mail/sendmail.cf | grep "DZ") #sendmail 버전 확인
updated_version="DZ8.17.1"

vuln_number="U30"
vuln_type="Sendmail 버전 점검"
vuln_result_date="$(date +%Y)-$(date +%m)-$(date +%d) $(date +%H):$(date +%M):$(date +%S)"
vuln_type="서비스 관리"
vuln_severity="3"
vuln_result="취약하지 않음"
vuln_desc="sendmail이 최신 버전으로 패치되어 있음"
vuln_host_id=$(hostname -I)


if [ -n "$value1" ] 
then
    value2=$(cat /etc/mail/sendmail.cf | grep "DZ") #Sendmail 버전 확인 / mail 폴더 없음 / telnet localhost 25 //가장최신버전 8.17.1
    if [ $value2 != $updated_version ]
    then
        vuln_result="취약함"
        vuln_desc="sendmail이 최신 버전이 아님"
    fi
else
    vuln_result="취약함"
    vuln_desc="sendmail을 사용하지 않고 있음"
fi

echo "{\"vuln_number\":\"${vuln_number}\", \"vuln_name\":\"${vuln_name}\", \"vuln_result_date\":\"${vuln_result_date}\", \"vuln_type\":\"${vuln_type}\", \"vuln_severity\":\"${vuln_severity}\", \"vuln_result\":\"${vuln_result}\", \"vuln_desc\":\"${vuln_desc}\", \"vuln_host_id\":\"${vuln_host_id}\"}" >> result.log
=======
# 작성자 : 우은지
# 동작방식 : sendmail 서비스를 활성화 되어있는지 확인하고 활성화 되어있다면 버전 확인

value1=$(ps -ef | grep "sendmail")

if [ -n "$value1" ] 
    then
        value2=$(cat /etc/mail/sendmail.cf | grep "DZ")
        echo -e "Check sendmail version -> $value2" >> u30.log
    else
        echo "not using sendmail service" >> u30.log
fi
>>>>>>> 03f5de9f689ec24457c298763162cb95ebfbba95
